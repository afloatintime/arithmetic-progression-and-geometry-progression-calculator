<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quadro Digital - Calculadora de Progress√µes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #2d5016;
            background-image: 
                linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px),
                linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            min-height: 100vh;
            padding: 20px;
        }

        .blackboard {
            background: #1a3d0a;
            border: 15px solid #8B4513;
            border-radius: 10px;
            box-shadow: 
                inset 0 0 20px rgba(0,0,0,0.5),
                0 10px 30px rgba(0,0,0,0.5);
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
            position: relative;
        }

        .blackboard::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 20px;
            background: #8B4513;
            border-radius: 10px;
        }

        h1 {
            color: #90EE90;
            text-align: center;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .subtitle {
            color: #98FB98;
            text-align: center;
            font-size: 1.3em;
            margin-bottom: 30px;
            font-style: italic;
        }

        .type-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .type-btn {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.9);
            border: 3px solid #333;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333;
        }

        .type-btn.active {
            background: #90EE90;
            border-color: #228B22;
            color: #000;
            transform: scale(1.05);
        }

        .type-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
        }

        .operation-selector {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed #90EE90;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .operation-title {
            color: #90EE90;
            font-size: 1.4em;
            text-align: center;
            margin-bottom: 15px;
            text-decoration: underline;
        }

        .operations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .operation-btn {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.85);
            border: 2px solid #333;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333;
            text-align: center;
        }

        .operation-btn.selected {
            background: #FFD700;
            border-color: #FF8C00;
            color: #000;
        }

        .operation-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .formula-board {
            background: rgba(255, 255, 255, 0.95);
            border: 3px solid #333;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #000;
        }

        .formula-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #8B4513;
            text-decoration: underline;
        }

        .formula-content {
            background: #f0f8ff;
            border: 2px dashed #4682B4;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            text-align: center;
            color: #000080;
        }

        .input-section {
            background: rgba(255, 255, 255, 0.9);
            border: 3px solid #333;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }

        .chalk-input {
            width: 100%;
            padding: 12px 15px;
            border: 3px solid #333;
            border-radius: 8px;
            font-size: 1.2em;
            font-family: 'Courier New', monospace;
            background: #FFFACD;
            color: #333;
            transition: all 0.3s ease;
        }

        .chalk-input:focus {
            outline: none;
            border-color: #228B22;
            background: #F0FFF0;
            box-shadow: 0 0 10px rgba(34, 139, 34, 0.3);
        }

        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #32CD32, #228B22);
            color: white;
            border: 3px solid #006400;
            border-radius: 12px;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(50, 205, 50, 0.4);
            background: linear-gradient(135deg, #3CB371, #2F4F4F);
        }

        .result-board {
            background: rgba(255, 255, 255, 0.95);
            border: 4px solid #8B4513;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            color: #333;
            display: none;
        }

        .result-board.show {
            display: block;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-title {
            font-size: 1.6em;
            text-align: center;
            color: #8B4513;
            margin-bottom: 20px;
            text-decoration: underline;
            font-weight: bold;
        }

        .calculation-steps {
            background: #F5F5DC;
            border: 2px solid #DDD;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .step {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 5px solid #32CD32;
        }

        .step-number {
            font-weight: bold;
            color: #8B4513;
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .step-content {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            line-height: 1.5;
        }

        .final-answer {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            border: 4px solid #228B22;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #006400;
            margin-top: 20px;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        .sequence-display {
            background: #E6E6FA;
            border: 3px dashed #9370DB;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #4B0082;
        }

        .error-message {
            background: #FFB6C1;
            border: 3px solid #DC143C;
            color: #8B0000;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            margin: 15px 0;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .blackboard {
                margin: 10px;
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .type-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .operations-grid {
                grid-template-columns: 1fr;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="blackboard">
        <h1>üìê Quadro Digital - Progress√µes</h1>
        <p class="subtitle">Aprendendo matem√°tica no quadro interativo!</p>
        
        <!-- Seletor de Tipo de Progress√£o -->
        <div class="type-selector">
            <button class="type-btn active" onclick="selectType('pa')">
                üìä Progress√£o Aritm√©tica (P.A.)
            </button>
            <button class="type-btn" onclick="selectType('pg')">
                üìà Progress√£o Geom√©trica (P.G.)
            </button>
        </div>

        <!-- Seletor de Opera√ß√£o -->
        <div class="operation-selector">
            <div class="operation-title">Escolha o que deseja calcular:</div>
            <div class="operations-grid">
                <button class="operation-btn" onclick="selectOperation('termo')">
                    üéØ Encontrar um Termo
                </button>
                <button class="operation-btn" onclick="selectOperation('razao')">
                    üîç Calcular a Raz√£o
                </button>
                <button class="operation-btn" onclick="selectOperation('soma_finita')">
                    ‚ûï Soma Finita (n termos)
                </button>
                <button class="operation-btn" onclick="selectOperation('soma_infinita')">
                    ‚àû Soma Infinita (s√≥ P.G.)
                </button>
            </div>
        </div>

        <!-- Quadro de F√≥rmulas -->
        <div id="formula-display" class="formula-board hidden">
            <div class="formula-title">üìö F√≥rmulas e Explica√ß√µes</div>
            <div id="formula-content"></div>
        </div>

        <!-- √Årea de Input -->
        <div class="input-section">
            <div id="input-fields" class="input-grid">
                <!-- Os campos ser√£o gerados dinamicamente -->
            </div>
            <button class="calculate-btn" onclick="calculate()">
                ‚ú® Resolver no Quadro
            </button>
        </div>

        <!-- Quadro de Resultados -->
        <div id="result-board" class="result-board">
            <div class="result-title">üìù Resolu√ß√£o Passo a Passo</div>
            <div id="calculation-content"></div>
        </div>
    </div>

    <script>
        let currentType = 'pa';
        let currentOperation = '';

        function selectType(type) {
            currentType = type;
            
            // Atualizar bot√µes
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Limpar sele√ß√£o de opera√ß√£o
            currentOperation = '';
            document.querySelectorAll('.operation-btn').forEach(btn => btn.classList.remove('selected'));
            document.getElementById('formula-display').classList.add('hidden');
            document.getElementById('input-fields').innerHTML = '';
            document.getElementById('result-board').classList.remove('show');
        }

        function selectOperation(operation) {
            // Verificar se soma infinita √© v√°lida para P.A.
            if (operation === 'soma_infinita' && currentType === 'pa') {
                alert('‚ö†Ô∏è Soma infinita s√≥ existe para Progress√µes Geom√©tricas com |q| < 1!');
                return;
            }
            
            currentOperation = operation;
            
            // Atualizar bot√µes
            document.querySelectorAll('.operation-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Mostrar f√≥rmula e gerar campos
            showFormula();
            generateInputFields();
            document.getElementById('result-board').classList.remove('show');
        }

        function showFormula() {
            const formulaDiv = document.getElementById('formula-content');
            const display = document.getElementById('formula-display');
            
            let content = '';
            
            if (currentType === 'pa') {
                switch (currentOperation) {
                    case 'termo':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula do Termo Geral:</strong><br>
                                a‚Çô = a‚ÇÅ + (n-1) √ó r<br><br>
                                <strong>Onde:</strong> a‚Çô = termo na posi√ß√£o n | a‚ÇÅ = primeiro termo | r = raz√£o
                            </div>
                            <p>üí° <strong>Dica:</strong> Na P.A., sempre somamos a mesma quantidade (raz√£o) para ir de um termo para o pr√≥ximo!</p>
                        `;
                        break;
                    case 'razao':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula da Raz√£o:</strong><br>
                                r = a‚Çô - a‚ÇÅ / (n-1)<br>
                                ou<br>
                                r = a‚ÇÇ - a‚ÇÅ
                            </div>
                            <p>üí° <strong>Dica:</strong> A raz√£o √© a diferen√ßa constante entre termos consecutivos!</p>
                        `;
                        break;
                    case 'soma_finita':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula da Soma de n Termos:</strong><br>
                                S‚Çô = n √ó (a‚ÇÅ + a‚Çô) / 2<br>
                                ou<br>
                                S‚Çô = n √ó (2√óa‚ÇÅ + (n-1)√ór) / 2
                            </div>
                            <p>üí° <strong>Dica:</strong> Somamos desde o primeiro at√© o n-√©simo termo da P.A.!</p>
                        `;
                        break;
                }
            } else { // P.G.
                switch (currentOperation) {
                    case 'termo':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula do Termo Geral:</strong><br>
                                a‚Çô = a‚ÇÅ √ó q^(n-1)<br><br>
                                <strong>Onde:</strong> a‚Çô = termo na posi√ß√£o n | a‚ÇÅ = primeiro termo | q = raz√£o
                            </div>
                            <p>üí° <strong>Dica:</strong> Na P.G., sempre multiplicamos pela mesma quantidade (raz√£o) para ir de um termo para o pr√≥ximo!</p>
                        `;
                        break;
                    case 'razao':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula da Raz√£o:</strong><br>
                                q = a‚Çô / a‚ÇÅ ^ (1/(n-1))<br>
                                ou<br>
                                q = a‚ÇÇ / a‚ÇÅ
                            </div>
                            <p>üí° <strong>Dica:</strong> A raz√£o √© o n√∫mero que multiplicamos para ir de um termo para o pr√≥ximo!</p>
                        `;
                        break;
                    case 'soma_finita':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula da Soma de n Termos:</strong><br>
                                Se q ‚â† 1: S‚Çô = a‚ÇÅ √ó (q^n - 1) / (q - 1)<br>
                                Se q = 1: S‚Çô = n √ó a‚ÇÅ
                            </div>
                            <p>üí° <strong>Dica:</strong> Somamos desde o primeiro at√© o n-√©simo termo da P.G.!</p>
                        `;
                        break;
                    case 'soma_infinita':
                        content = `
                            <div class="formula-content">
                                <strong>F√≥rmula da Soma Infinita:</strong><br>
                                S‚àû = a‚ÇÅ / (1 - q)<br><br>
                                <strong>Condi√ß√£o:</strong> |q| < 1
                            </div>
                            <p>üí° <strong>Dica:</strong> S√≥ converge quando a raz√£o est√° entre -1 e 1 (sem incluir)!</p>
                        `;
                        break;
                }
            }
            
            formulaDiv.innerHTML = content;
            display.classList.remove('hidden');
        }

        function generateInputFields() {
            const inputDiv = document.getElementById('input-fields');
            let fields = '';
            
            switch (currentOperation) {
                case 'termo':
                    fields = `
                        <div class="input-group">
                            <label>üåü Primeiro termo (a‚ÇÅ):</label>
                            <input type="number" id="a1" class="chalk-input" placeholder="Ex: 2">
                        </div>
                        <div class="input-group">
                            <label>${currentType === 'pa' ? '‚ûï Raz√£o (r):' : '‚úñÔ∏è Raz√£o (q):'}</label>
                            <input type="number" id="razao" class="chalk-input" placeholder="${currentType === 'pa' ? 'Ex: 3' : 'Ex: 2'}">
                        </div>
                        <div class="input-group">
                            <label>üéØ Posi√ß√£o do termo (n):</label>
                            <input type="number" id="n" class="chalk-input" placeholder="Ex: 5" min="1">
                        </div>
                    `;
                    break;
                case 'razao':
                    fields = `
                        <div class="input-group">
                            <label>üåü Primeiro termo (a‚ÇÅ):</label>
                            <input type="number" id="a1" class="chalk-input" placeholder="Ex: 2">
                        </div>
                        <div class="input-group">
                            <label>üéØ Outro termo conhecido:</label>
                            <input type="number" id="an" class="chalk-input" placeholder="Ex: 14">
                        </div>
                        <div class="input-group">
                            <label>üìç Posi√ß√£o desse termo:</label>
                            <input type="number" id="n" class="chalk-input" placeholder="Ex: 5" min="2">
                        </div>
                    `;
                    break;
                case 'soma_finita':
                    fields = `
                        <div class="input-group">
                            <label>üåü Primeiro termo (a‚ÇÅ):</label>
                            <input type="number" id="a1" class="chalk-input" placeholder="Ex: 2">
                        </div>
                        <div class="input-group">
                            <label>${currentType === 'pa' ? '‚ûï Raz√£o (r):' : '‚úñÔ∏è Raz√£o (q):'}</label>
                            <input type="number" id="razao" class="chalk-input" placeholder="${currentType === 'pa' ? 'Ex: 3' : 'Ex: 2'}">
                        </div>
                        <div class="input-group">
                            <label>üî¢ Quantidade de termos (n):</label>
                            <input type="number" id="n" class="chalk-input" placeholder="Ex: 5" min="1">
                        </div>
                    `;
                    break;
                case 'soma_infinita':
                    fields = `
                        <div class="input-group">
                            <label>üåü Primeiro termo (a‚ÇÅ):</label>
                            <input type="number" id="a1" class="chalk-input" placeholder="Ex: 1">
                        </div>
                        <div class="input-group">
                            <label>‚úñÔ∏è Raz√£o (q) - deve ser |q| < 1:</label>
                            <input type="number" id="razao" class="chalk-input" placeholder="Ex: 0.5" step="0.1">
                        </div>
                    `;
                    break;
            }
            
            inputDiv.innerHTML = fields;
        }

        function calculate() {
            if (!currentOperation) {
                alert('‚ö†Ô∏è Por favor, escolha uma opera√ß√£o primeiro!');
                return;
            }
            
            const resultDiv = document.getElementById('calculation-content');
            
            try {
                let result = '';
                
                switch (currentOperation) {
                    case 'termo':
                        result = calculateTerm();
                        break;
                    case 'razao':
                        result = calculateRatio();
                        break;
                    case 'soma_finita':
                        result = calculateFiniteSum();
                        break;
                    case 'soma_infinita':
                        result = calculateInfiniteSum();
                        break;
                }
                
                resultDiv.innerHTML = result;
                document.getElementById('result-board').classList.add('show');
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="error-message">‚ùå ${error.message}</div>`;
                document.getElementById('result-board').classList.add('show');
            }
        }

        function calculateTerm() {
            const a1 = parseFloat(document.getElementById('a1').value);
            const razao = parseFloat(document.getElementById('razao').value);
            const n = parseInt(document.getElementById('n').value);
            
            if (isNaN(a1) || isNaN(razao) || isNaN(n) || n < 1) {
                throw new Error('Por favor, preencha todos os campos com n√∫meros v√°lidos!');
            }
            
            let an, sequence = [], steps = '';
            
            if (currentType === 'pa') {
                an = a1 + (n - 1) * razao;
                
                // Gerar sequ√™ncia
                for (let i = 1; i <= Math.min(n, 8); i++) {
                    sequence.push(a1 + (i - 1) * razao);
                }
                
                steps = `
                    <div class="step">
                        <div class="step-number">Passo 1: Identificar os dados</div>
                        <div class="step-content">
                            a‚ÇÅ = ${a1}<br>
                            r = ${razao}<br>
                            n = ${n}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                        <div class="step-content">
                            a‚Çô = a‚ÇÅ + (n-1) √ó r<br>
                            a${n} = ${a1} + (${n}-1) √ó ${razao}<br>
                            a${n} = ${a1} + ${n-1} √ó ${razao}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 3: Resolver</div>
                        <div class="step-content">
                            a${n} = ${a1} + ${(n-1) * razao}<br>
                            a${n} = ${an}
                        </div>
                    </div>
                `;
            } else {
                if (razao === 0) {
                    throw new Error('A raz√£o n√£o pode ser zero!');
                }
                
                an = a1 * Math.pow(razao, n - 1);
                
                // Gerar sequ√™ncia
                let current = a1;
                for (let i = 1; i <= Math.min(n, 8); i++) {
                    sequence.push(parseFloat(current.toFixed(6)));
                    current *= razao;
                    if (Math.abs(current) > 1000000) break;
                }
                
                steps = `
                    <div class="step">
                        <div class="step-number">Passo 1: Identificar os dados</div>
                        <div class="step-content">
                            a‚ÇÅ = ${a1}<br>
                            q = ${razao}<br>
                            n = ${n}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                        <div class="step-content">
                            a‚Çô = a‚ÇÅ √ó q^(n-1)<br>
                            a${n} = ${a1} √ó ${razao}^(${n}-1)<br>
                            a${n} = ${a1} √ó ${razao}^${n-1}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 3: Resolver</div>
                        <div class="step-content">
                            a${n} = ${a1} √ó ${Math.pow(razao, n-1)}<br>
                            a${n} = ${an}
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="calculation-steps">${steps}</div>
                <div class="sequence-display">
                    üî¢ Sequ√™ncia: ${sequence.join(', ')}${sequence.length < n ? '...' : ''}
                </div>
                <div class="final-answer">
                    üéâ O ${n}¬∫ termo √©: ${an}
                </div>
            `;
        }

        function calculateRatio() {
            const a1 = parseFloat(document.getElementById('a1').value);
            const an = parseFloat(document.getElementById('an').value);
            const n = parseInt(document.getElementById('n').value);
            
            if (isNaN(a1) || isNaN(an) || isNaN(n) || n < 2) {
                throw new Error('Por favor, preencha todos os campos com n√∫meros v√°lidos! A posi√ß√£o deve ser ‚â• 2.');
            }
            
            let razao, steps = '';
            
            if (currentType === 'pa') {
                razao = (an - a1) / (n - 1);
                
                steps = `
                    <div class="step">
                        <div class="step-number">Passo 1: Identificar os dados</div>
                        <div class="step-content">
                            a‚ÇÅ = ${a1}<br>
                            a${n} = ${an}<br>
                            n = ${n}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                        <div class="step-content">
                            r = (a‚Çô - a‚ÇÅ) / (n - 1)<br>
                            r = (${an} - ${a1}) / (${n} - 1)<br>
                            r = ${an - a1} / ${n - 1}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 3: Resolver</div>
                        <div class="step-content">
                            r = ${razao}
                        </div>
                    </div>
                `;
            } else {
                if (a1 === 0) {
                    throw new Error('O primeiro termo n√£o pode ser zero!');
                }
                
                razao = Math.pow(an / a1, 1 / (n - 1));
                
                steps = `
                    <div class="step">
                        <div class="step-number">Passo 1: Identificar os dados</div>
                        <div class="step-content">
                            a‚ÇÅ = ${a1}<br>
                            a${n} = ${an}<br>
                            n = ${n}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                        <div class="step-content">
                            q = (a‚Çô / a‚ÇÅ)^(1/(n-1))<br>
                            q = (${an} / ${a1})^(1/(${n}-1))<br>
                            q = (${an / a1})^(1/${n - 1})
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 3: Resolver</div>
                        <div class="step-content">
                            q = ${razao.toFixed(6)}
                        </div>
                    </div>
                `;
            }
            
            return `
                <div class="calculation-steps">${steps}</div>
                <div class="final-answer">
                    üéâ A raz√£o √©: ${currentType === 'pa' ? razao : razao.toFixed(6)}
                </div>
            `;
        }

        function calculateFiniteSum() {
            const a1 = parseFloat(document.getElementById('a1').value);
            const razao = parseFloat(document.getElementById('razao').value);
            const n = parseInt(document.getElementById('n').value);
            
            if (isNaN(a1) || isNaN(razao) || isNaN(n) || n < 1) {
                throw new Error('Por favor, preencha todos os campos com n√∫meros v√°lidos!');
            }
            
            let soma, sequence = [], steps = '';
            
            if (currentType === 'pa') {
                const an = a1 + (n - 1) * razao;
                soma = (n * (a1 + an)) / 2;
                
                // Gerar sequ√™ncia
                for (let i = 1; i <= Math.min(n, 10); i++) {
                    sequence.push(a1 + (i - 1) * razao);
                }
                
                steps = `
                    <div class="step">
                        <div class="step-number">Passo 1: Identificar os dados</div>
                        <div class="step-content">
                            a‚ÇÅ = ${a1}<br>
                            r = ${razao}<br>
                            n = ${n}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 2: Encontrar o √∫ltimo termo</div>
                        <div class="step-content">
                            a‚Çô = a‚ÇÅ + (n-1) √ó r<br>
                            a${n} = ${a1} + (${n}-1) √ó ${razao}<br>
                            a${n} = ${an}
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 3: Aplicar a f√≥rmula da soma</div>
                        <div class="step-content">
                            S‚Çô = n √ó (a‚ÇÅ + a‚Çô) / 2<br>
                            S${n} = ${n} √ó (${a1} + ${an}) / 2<br>
                            S${n} = ${n} √ó ${a1 + an} / 2
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">Passo 4: Resolver</div>
                        <div class="step-content">
                            S${n} = ${soma}
                        </div>
                    </div>
                `;
            } else {
                if (razao === 0) {
                    throw new Error('A raz√£o n√£o pode ser zero!');
                }
                
                if (razao === 1) {
                    soma = n * a1;
                    steps = `
                        <div class="step">
                            <div class="step-number">Caso especial: q = 1</div>
                            <div class="step-content">
                                Quando q = 1, todos os termos s√£o iguais a a‚ÇÅ<br>
                                S‚Çô = n √ó a‚ÇÅ<br>
                                S${n} = ${n} √ó ${a1} = ${soma}
                            </div>
                        </div>
                    `;
                } else {
                    soma = a1 * (Math.pow(razao, n) - 1) / (razao - 1);
                    
                    steps = `
                        <div class="step">
                            <div class="step-number">Passo 1: Identificar os dados</div>
                            <div class="step-content">
                                a‚ÇÅ = ${a1}<br>
                                q = ${razao}<br>
                                n = ${n}
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                            <div class="step-content">
                                S‚Çô = a‚ÇÅ √ó (q‚Åø - 1) / (q - 1)<br>
                                S${n} = ${a1} √ó (${razao}^${n} - 1) / (${razao} - 1)<br>
                                S${n} = ${a1} √ó (${Math.pow(razao, n)} - 1) / ${razao - 1}
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">Passo 3: Resolver</div>
                            <div class="step-content">
                                S${n} = ${a1} √ó ${Math.pow(razao, n) - 1} / ${razao - 1}<br>
                                S${n} = ${soma.toFixed(6)}
                            </div>
                        </div>
                    `;
                }
                
                // Gerar sequ√™ncia
                let current = a1;
                for (let i = 1; i <= Math.min(n, 8); i++) {
                    sequence.push(parseFloat(current.toFixed(4)));
                    current *= razao;
                    if (Math.abs(current) > 1000000) break;
                }
            }
            
            return `
                <div class="calculation-steps">${steps}</div>
                <div class="sequence-display">
                    üî¢ Primeiros termos: ${sequence.join(' + ')}${sequence.length < n ? ' + ...' : ''}
                </div>
                <div class="final-answer">
                    üéâ A soma dos ${n} primeiros termos √©: ${currentType === 'pa' ? soma : soma.toFixed(6)}
                </div>
            `;
        }

        function calculateInfiniteSum() {
            const a1 = parseFloat(document.getElementById('a1').value);
            const q = parseFloat(document.getElementById('razao').value);
            
            if (isNaN(a1) || isNaN(q)) {
                throw new Error('Por favor, preencha todos os campos com n√∫meros v√°lidos!');
            }
            
            if (Math.abs(q) >= 1) {
                throw new Error('Para soma infinita, a raz√£o deve satisfazer |q| < 1!');
            }
            
            const soma = a1 / (1 - q);
            
            // Gerar alguns termos da sequ√™ncia
            let sequence = [];
            let current = a1;
            for (let i = 1; i <= 8; i++) {
                sequence.push(parseFloat(current.toFixed(6)));
                current *= q;
            }
            
            const steps = `
                <div class="step">
                    <div class="step-number">Passo 1: Verificar converg√™ncia</div>
                    <div class="step-content">
                        |q| = |${q}| = ${Math.abs(q)} < 1 ‚úì<br>
                        A s√©rie converge!
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">Passo 2: Aplicar a f√≥rmula</div>
                    <div class="step-content">
                        S‚àû = a‚ÇÅ / (1 - q)<br>
                        S‚àû = ${a1} / (1 - ${q})<br>
                        S‚àû = ${a1} / ${1 - q}
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">Passo 3: Resolver</div>
                    <div class="step-content">
                        S‚àû = ${soma.toFixed(6)}
                    </div>
                </div>
            `;
            
            return `
                <div class="calculation-steps">${steps}</div>
                <div class="sequence-display">
                    üî¢ Sequ√™ncia infinita: ${sequence.join(' + ')} + ...
                </div>
                <div class="final-answer">
                    üéâ A soma infinita √©: ${soma.toFixed(6)}
                </div>
            `;
        }

        // Suporte para tecla Enter
        document.addEventListener('DOMContentLoaded', function() {
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const inputs = document.querySelectorAll('.chalk-input');
                    let allFilled = true;
                    inputs.forEach(input => {
                        if (!input.value) allFilled = false;
                    });
                    if (allFilled && currentOperation) {
                        calculate();
                    }
                }
            });
        });

        // Anima√ß√£o de giz
        document.addEventListener('mousemove', function(e) {
            if (Math.random() > 0.95) {
                const chalk = document.createElement('div');
                chalk.style.position = 'fixed';
                chalk.style.left = e.clientX + 'px';
                chalk.style.top = e.clientY + 'px';
                chalk.style.width = '2px';
                chalk.style.height = '2px';
                chalk.style.backgroundColor = 'rgba(255, 255, 255, 0.5)';
                chalk.style.borderRadius = '50%';
                chalk.style.pointerEvents = 'none';
                chalk.style.zIndex = '1000';
                document.body.appendChild(chalk);
                
                setTimeout(() => {
                    chalk.remove();
                }, 500);
            }
        });
    </script>
</body>
</html>
